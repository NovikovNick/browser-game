[{"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/index.js":"1","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/App.js":"2","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/container/Board.js":"3","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/reducers/index.js":"4","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/component/Player.js":"5","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/ActionTypes.js":"6","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/ReduxActions.js":"7","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/container/WebSocket.js":"8","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/reducers/players.js":"9"},{"size":220,"mtime":1609837294878,"results":"10","hashOfConfig":"11"},{"size":2058,"mtime":1609947837928,"results":"12","hashOfConfig":"11"},{"size":937,"mtime":1609946960597,"results":"13","hashOfConfig":"11"},{"size":45,"mtime":1609929310065,"results":"14","hashOfConfig":"11"},{"size":449,"mtime":1609947067241,"results":"15","hashOfConfig":"11"},{"size":96,"mtime":1609947762120,"results":"16","hashOfConfig":"11"},{"size":227,"mtime":1609947762132,"results":"17","hashOfConfig":"11"},{"size":2552,"mtime":1609936220922,"results":"18","hashOfConfig":"11"},{"size":680,"mtime":1609947762136,"results":"19","hashOfConfig":"11"},{"filePath":"20","messages":"21","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},"1lgwz23",{"filePath":"23","messages":"24","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"25","usedDeprecatedRules":"22"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},{"filePath":"32","messages":"33","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"38","usedDeprecatedRules":"22"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"41"},"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/index.js",[],["42","43"],"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/App.js",["44"],"import React from 'react';\nimport {combineReducers, createStore} from 'redux';\nimport {Provider} from 'react-redux';\n\nimport * as reducers from './store/reducers';\n\nimport './App.css';\nimport Board from \"./container/Board\";\nimport WebSocket from \"./container/WebSocket\";\nimport * as actions from \"./store/ReduxActions\";\n\n\nconst store = createStore(combineReducers(reducers),\n    window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__());\n\nlet timerId = setTimeout(function tick() {\n\n    const snapshots = store.getState().state.snapshots;\n\n    if (snapshots) {\n        const fst = snapshots[0]\n        const snd = snapshots[1]\n        if (fst && snd && fst.players && snd.players) {\n\n            const fstGroupedById = fst.players.reduce((r, a) => {\n                r[a.id] = a;\n                return r;\n            }, {});\n\n            const sndGroupedById = snd.players.reduce((r, a) => {\n                r[a.id] = a;\n                return r;\n            }, {});\n\n            const frame = fst.timestamp - snd.timestamp;\n            const timestamp = new Date().getTime();\n            const delay = timestamp - fst.timestamp;\n            const mod = frame < delay ? 1 : delay / frame;\n\n            const players = [];\n            for (const [id, value] of Object.entries(fstGroupedById)) {\n                if (sndGroupedById[id]) {\n                    const p1 = value\n                    const p2 = sndGroupedById[id]\n                    const player = {\n                        id: id,\n                        x: p2.x + (p1.x - p2.x) * mod,\n                        y: p2.y + (p1.y - p2.y) * mod\n                    };\n                    players.push(player);\n                }\n            }\n            store.dispatch(actions.updateState(players));\n        }\n    }\n\n    timerId = setTimeout(tick, 15);\n}, 15);\n\nfunction App() {\n    return (\n        <Provider store={store}>\n            <div className=\"App\">\n                <WebSocket/>\n                <Board/>\n            </div>\n        </Provider>\n    );\n}\n\nexport default App;\n","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/container/Board.js",[],"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/reducers/index.js",[],"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/component/Player.js",[],"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/ActionTypes.js",[],"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/ReduxActions.js",[],"/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/container/WebSocket.js",["45"],"import {Client} from \"@stomp/stompjs\";\nimport * as SockJS from 'sockjs-client';\n\nimport React, {useEffect} from 'react';\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport * as Store from \"../store/ReduxActions\";\n\nexport function restart() {\n\n    webSocket.deactivate();\n    webSocket.activate();\n}\n\nvar x = null;\nvar y = null;\n\nfunction onMouseUpdate(e) {\n\n    x = e.pageX;\n    y = e.pageY;\n}\n\nexport function sendMessage() {\n\n    webSocket.publish({\n        destination: ENDPOINT.TOPIC_PLAYER_UPDATE,\n        body: JSON.stringify({x: x, y: y})\n    });\n}\n\n\nconst ENDPOINT = {\n    HOST: \"http://192.168.0.103:8080\",\n    APP_NAME: \"/game\",\n    TOPIC_PLAYER_LIST: '/backend/player/list',\n    TOPIC_PLAYER_UPDATE: '/frontend/update'\n};\n\nconst webSocket = new Client();\n\nfunction WebSocket({snapshots, actions}) {\n\n    useEffect(() => {\n        webSocket.configure({\n            webSocketFactory: function () {\n                return new SockJS(ENDPOINT.HOST + ENDPOINT.APP_NAME);\n            },\n            onConnect: (frame) => {\n\n                var url = webSocket.webSocket._transport.url;\n                url = url.split(\"/\");\n                var sessionId = url[url.length - 2];\n                webSocket.sessionId = sessionId;\n\n                webSocket.subscribe(ENDPOINT.TOPIC_PLAYER_LIST, message => {\n                    const state = JSON.parse(message.body);\n                    actions.addSnapshot(state);\n                });\n            },\n            onWebSocketError: (e) => {\n                console.error(\"Chat service is unavailable\");\n            },\n            // debug: str => console.log(new Date(), str)\n        });\n\n        document.addEventListener('mousemove', onMouseUpdate, false);\n        document.addEventListener('mouseenter', onMouseUpdate, false);\n    })\n\n    return (\n        <div className={\"controls\"}>\n            <button onClick={() => {\n                restart()\n            }}>\n                Connect\n            </button>\n\n            <button onClick={() => {\n                let timerId = setTimeout(function tick() {\n                    sendMessage()\n                    timerId = setTimeout(tick, 100); // (*)\n                }, 100);\n            }}>\n                Send position\n            </button>\n        </div>\n    );\n}\n\nconst mapStateToProps = state => ({\n    snapshots: state.state.snapshots\n});\nconst mapDispatchToProps = dispatch => ({\n    actions: bindActionCreators(Store, dispatch)\n});\nexport default connect(mapStateToProps, mapDispatchToProps)(WebSocket);\n","/home/nicknovikov/WORKSPACE/small-test-server/frontend/src/store/reducers/players.js",[],["46","47"],{"ruleId":"48","replacedBy":"49"},{"ruleId":"50","replacedBy":"51"},{"ruleId":"52","severity":1,"message":"53","line":57,"column":5,"nodeType":"54","messageId":"55","endLine":57,"endColumn":12},{"ruleId":"52","severity":1,"message":"53","line":83,"column":21,"nodeType":"54","messageId":"55","endLine":83,"endColumn":28},{"ruleId":"48","replacedBy":"56"},{"ruleId":"50","replacedBy":"57"},"no-native-reassign",["58"],"no-negated-in-lhs",["59"],"no-unused-vars","'timerId' is assigned a value but never used.","Identifier","unusedVar",["58"],["59"],"no-global-assign","no-unsafe-negation"]